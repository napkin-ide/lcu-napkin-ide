<ng-container *ngIf="!State.Loading">
  <section
    class="welcome"
    *ngIf="State.UserSetupStep == UserSetupStepTypes.Welcome"
  >
    <div class="spread" fxLayout="row" fxLayout="center center">
      <div fxFlex="auto"></div>

      <div fxFlex="40%" fxFlex.lt-md="60%" fxFlex.lt-sm="90%">
        <h2>Welcome to Fathym<br />Fathym It. Build It.</h2>

        <p>
          Being a developer is more than just the languages you know, the code
          you right, the IDEs you use, the cloud you choose, and the tools you
          prefer; its the way you use them to create solutions to real problems.
        </p>

        <p>
          Use the technology you prefer with Fathym to deliver quality solutions
          to your customers.
        </p>

        <button
          mat-raised-button
          color="accent"
          class="mat-full-width"
          (click)="SetUserSetupStep(UserSetupStepTypes.Setup)"
        >
          Start Setup
        </button>
      </div>

      <div fxFlex="auto"></div>
    </div>
  </section>

  <section
    class="setup"
    *ngIf="State.UserSetupStep == UserSetupStepTypes.Setup"
  >
    <div fxLayout="row wrap" fxLayout="center center">
      <div fxFlex="40%" fxFlex.lt-sm="80%">
        <div class="spread text-center">
          <h2>Connect Your Cloud</h2>

          <p>Fathym will support you in getting the most out of your cloud.</p>
        </div>
      </div>

      <div fxFlex="60%" fxFlex.lt-sm="80%">
        <mat-horizontal-stepper [linear]="true" #stepper>
          <mat-step [stepControl]="DetailsForm">
            <form [formGroup]="DetailsForm">
              <ng-template matStepLabel>Organization</ng-template>

              <mat-form-field class="mat-full-width">
                <input
                  matInput
                  placeholder="Organization Name"
                  formControlName="orgDetailName"
                  required
                />

                <mat-icon
                  matSuffix
                  matTooltip="Enter a unique name for your new organization"
                  matTooltipClass="tooltip-background"
                  >help_outline</mat-icon
                >
              </mat-form-field>

              <mat-form-field class="mat-full-width">
                <textarea
                  matInput
                  placeholder="Description"
                  formControlName="orgDetailDesc"
                  required
                ></textarea>

                <mat-icon
                  matSuffix
                  matTooltip="Enter a useful description for your new organization"
                  matTooltipClass="tooltip-background"
                  >help_outline</mat-icon
                >
              </mat-form-field>

              <mat-form-field class="mat-full-width">
                <input
                  matInput
                  placeholder="Organization Lookup"
                  formControlName="orgDetailLookup"
                  required
                />

                <mat-icon
                  matSuffix
                  matTooltip="Enter a valid organization lookup (lowercase alpha characters and '-' accepted)"
                  matTooltipClass="tooltip-background"
                >
                  help_outline
                </mat-icon>
              </mat-form-field>

              <div>
                <button
                  mat-raised-button
                  color="accent"
                  class="mat-full-width"
                  [disabled]="!DetailsForm.valid"
                  matStepperNext
                >
                  Next
                </button>

                <button
                  mat-button
                  class="mat-full-width"
                  color="warn"
                  (click)="SetUserSetupStep(UserSetupStepTypes.Welcome)"
                >
                  Back
                </button>
              </div>
            </form>
          </mat-step>
          <mat-step [stepControl]="InfraForm">
            <form [formGroup]="InfraForm">
              <ng-template matStepLabel>Billing</ng-template>

              <mat-form-field class="mat-full-width">
                <div fxLayout="row" fxLayoutGap="10px">
                  <mat-icon
                    *ngIf="
                      OrgInfraAzureAppAppId.value.length > 0 &&
                      !OrgInfraAzureAppAppId.hasError('pattern')
                    "
                    class="success"
                    >check_circle</mat-icon
                  >
                  <input
                    formControlName="azureAppId"
                    matInput
                    placeholder="Azure App ID"
                    [type]="HideAppId ? 'password' : 'text'"
                    required
                    autocomplete="new-password"
                  />
                </div>
                <mat-error *ngIf="OrgInfraAzureAppAppId.hasError('pattern')">
                  {{ GuidErrorMessage }}
                </mat-error>
                <mat-icon
                  matBadgePosition="below after"
                  matBadgeColor="primary"
                  matBadgeOverlap="false"
                  color="warn"
                  matSuffix
                  (click)="HideAppId = !HideAppId"
                  class="cursor-pointer"
                  >{{ HideAppId ? "visibility_off" : "visibility" }}
                </mat-icon>
                <mat-icon
                  matSuffix
                  (click)="OpenHelpPdf()"
                  matTooltip="Obtain this value from the App Registration in Azure’s Active Directory. Click for more detailed instructions."
                  matTooltipClass="tooltip-background"
                  >help_outline</mat-icon
                >
                <!-- matBadge="{{OrgInfraAzureAppAppId.value.length}}"  -->
                <mat-hint>Guid Value</mat-hint>
              </mat-form-field>

              <mat-form-field class="mat-full-width margin-top-4">
                <div fxLayout="row" fxLayoutGap="10px">
                  <mat-icon
                    *ngIf="
                      OrgInfraAzureTenatId.value.length > 0 &&
                      !OrgInfraAzureTenatId.hasError('pattern')
                    "
                    class="success"
                    >check_circle</mat-icon
                  >
                  <input
                    formControlName="azureTenantId"
                    matInput
                    placeholder="Azure Tenant (Directory) ID"
                    [type]="HideTenantId ? 'password' : 'text'"
                    required
                    autocomplete="new-password"
                  />
                </div>
                <mat-error *ngIf="OrgInfraAzureTenatId.hasError('pattern')">
                  {{ GuidErrorMessage }}
                </mat-error>
                <mat-icon
                  matBadgePosition="below after"
                  matBadgeColor="primary"
                  matBadgeOverlap="false"
                  color="warn"
                  matSuffix
                  (click)="HideTenantId = !HideTenantId"
                  class="cursor-pointer"
                  >{{ HideTenantId ? "visibility_off" : "visibility" }}
                </mat-icon>
                <mat-icon
                  matSuffix
                  (click)="OpenHelpPdf()"
                  matTooltip="Obtain this value from the App Registration in Azure’s Active Directory. Click for more detailed instructions."
                  matTooltipClass="tooltip-background"
                  >help_outline</mat-icon
                >
                <!-- matBadge="{{OrgInfraAzureTenatId.value.length}}"  -->
                <mat-hint>Guid Value</mat-hint>
              </mat-form-field>

              <mat-form-field class="mat-full-width margin-top-4">
                <div fxLayout="row" fxLayoutGap="10px">
                  <mat-icon
                    *ngIf="
                      OrgInfraAzureSubId.value.length > 0 &&
                      !OrgInfraAzureSubId.hasError('pattern')
                    "
                    class="success"
                    >check_circle</mat-icon
                  >
                  <input
                    formControlName="azureSubId"
                    matInput
                    placeholder="Azure Subscription ID"
                    [type]="HideSubId ? 'password' : 'text'"
                    required
                    autocomplete="new-password"
                  />
                </div>
                <mat-error *ngIf="OrgInfraAzureSubId.hasError('pattern')">
                  {{ GuidErrorMessage }}
                </mat-error>
                <mat-icon
                  matBadgePosition="below after"
                  matBadgeColor="primary"
                  matBadgeOverlap="false"
                  color="warn"
                  matSuffix
                  (click)="HideSubId = !HideSubId"
                  class="cursor-pointer"
                  >{{ HideSubId ? "visibility_off" : "visibility" }}
                </mat-icon>
                <mat-icon
                  matSuffix
                  (click)="OpenHelpPdf()"
                  matTooltip="Obtain this value from the App Registration in Azure’s Active Directory. Click for more detailed instructions."
                  matTooltipClass="tooltip-background"
                  >help_outline</mat-icon
                >
                <!-- matBadge="{{OrgInfraAzureSubId.value.length}}"  -->
                <mat-hint>Guid Value</mat-hint>
              </mat-form-field>

              <mat-form-field class="mat-full-width margin-top-4">
                <div fxLayout="row" fxLayoutGap="10px">
                  <mat-icon
                    *ngIf="
                      OrgInfraAzureAppAuthKey.value.length > 0 &&
                      !OrgInfraAzureAppAuthKey.hasError('required')
                    "
                    class="success"
                    >check_circle</mat-icon
                  >
                  <input
                    formControlName="azureAppAuthKey"
                    matInput
                    placeholder="Azure App Auth key"
                    [type]="HideAuthKey ? 'password' : 'text'"
                    required
                    autocomplete="new-password"
                  />
                </div>
                <mat-error *ngIf="OrgInfraAzureAppAuthKey.hasError">
                  Value is required
                </mat-error>
                <mat-icon
                  matBadgePosition="below after"
                  matBadgeColor="primary"
                  matBadgeOverlap="false"
                  color="warn"
                  matSuffix
                  (click)="HideAuthKey = !HideAuthKey"
                  class="cursor-pointer"
                  >{{ HideAuthKey ? "visibility_off" : "visibility" }}
                </mat-icon>
                <mat-icon
                  matSuffix
                  (click)="OpenHelpPdf()"
                  matTooltip=" Obtain this value from Azure’s Certificates and Secrets page. Click for more detailed instructions."
                  matTooltipClass="tooltip-background"
                  >help_outline</mat-icon
                >
                <!-- matBadge="{{OrgInfraAzureAppAuthKey.value.length}}"  -->
                <!-- <mat-hint>32 Character Limit</mat-hint> -->
              </mat-form-field>

              <div>
                <button
                  matTooltip="Your best practices IoT cloud infrastructure is being set up. If you were doing this from scratch, it would take several days, but with Fathym it will only take up to 15 minutes."
                  matTooltipClass="tooltip-background"
                  mat-raised-button
                  color="accent"
                  class="mat-full-width"
                  matStepperNext
                  [disabled]="!InfraForm.valid"
                >
                  Next
                </button>

                <button
                  mat-button
                  class="mat-full-width"
                  color="warn"
                  matStepperPrevious
                >
                  Back
                </button>
              </div>
            </form>
          </mat-step>
          <mat-step [stepControl]="secondFormGroup">
            <form [formGroup]="secondFormGroup">
              <ng-template matStepLabel>Billing</ng-template>
              <mat-form-field>
                <mat-label>Address</mat-label>
                <input
                  matInput
                  formControlName="secondCtrl"
                  placeholder="Ex. 1 Main St, New York, NY"
                  required
                />
              </mat-form-field>
              <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext>Next</button>
              </div>
            </form>
          </mat-step>
          <mat-step>
            <ng-template matStepLabel>Review</ng-template>
            <p>You are now done.</p>
            <div>
              <button mat-button matStepperPrevious>Back</button>

              <button mat-button (click)="stepper.reset()">Reset</button>
            </div>
          </mat-step>
        </mat-horizontal-stepper>
      </div>
    </div>
  </section>
</ng-container>

<div *ngIf="State.Loading">
  <p style="text-align: center;">
    Behind the scenes Thinky is working hard to set up your Low Code Unit
  </p>

  <!-- <p style="text-align: center;"></p> -->

  <div fxLayout="row" fxLayoutAlign="center center" class="spinner-container">
    <mat-spinner diameter="75"></mat-spinner>
    <div class="spinner-logo" logo-alt="Fathym Logo"></div>
  </div>
</div>

<!-- <button mat-raised-button color="primary" (click)="SetUserDetails()">Set User Details</button> -->
